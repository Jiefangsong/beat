      double precision function mscorr(st1,di1,ra1,st2,di2,ra2)
      implicit none
c
c     corralation between two source mechanism (st,di and ra in degree)
c
c     input:
c
      double precision st1,di1,ra1,st2,di2,ra2
c
c     local memories:
c
      integer i,j,k
      double precision sss,sss2,ss2s,ssd,ssd2,ss2d,ssr,ssr2,ss2r
      double precision css,css2,cs2s,csd,csd2,cs2d,csr,csr2,cs2r
      double precision st(2),di(2),ra(2)
      double precision sm(3,3,2)
c
      double precision PI,DEG2RAD
      data PI,DEG2RAD/3.14159265358979d0,1.745329252d-02/
c
      st(1)=st1*DEG2RAD
      di(1)=di1*DEG2RAD
      ra(1)=ra1*DEG2RAD
      st(2)=st2*DEG2RAD
      di(2)=di2*DEG2RAD
      ra(2)=ra2*DEG2RAD
      do k=1,2
        sss=dsin(st(k))
        sss2=sss*sss
        ss2s=dsin(2.d0*st(k))
        ssd=dsin(di(k))
        ssd2=ssd*ssd
        ss2d=dsin(2.d0*di(k))
c
        css=dcos(st(k))
        css2=css*css
        cs2s=dcos(2.d0*st(k))
        csd=dcos(di(k))
        csd2=csd*csd
        cs2d=dcos(2.d0*di(k))
c
        ssr=dsin(ra(k))
        ssr2=ssr*ssr
        ss2r=dsin(2.d0*ra(k))
c
        csr=dcos(ra(k))
        csr2=csr*csr
        cs2r=dcos(2.d0*ra(k))
c
        sm(1,1,k)=-ssd*csr*ss2s-ss2d*ssr*sss2
        sm(2,2,k)= ssd*csr*ss2s-ss2d*ssr*css2
        sm(3,3,k)=-(sm(1,1,k)+sm(2,2,k))
        sm(1,2,k)= ssd*csr*cs2s+0.5d0*ss2d*ssr*ss2s
        sm(2,1,k)=sm(1,2,k)
        sm(2,3,k)=-csd*csr*sss+cs2d*ssr*css
        sm(3,2,k)=sm(2,3,k)
        sm(3,1,k)=-csd*csr*css-cs2d*ssr*sss
        sm(1,3,k)=sm(3,1,k)
      enddo
      mscorr=0.
      do i=1,3
        do j=1,3
          mscorr=mscorr+sm(i,j,1)*sm(j,i,2)
        enddo
      enddo
      return
      end